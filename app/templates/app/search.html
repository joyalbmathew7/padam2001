{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Search Users</title>
</head>
<body>

<h1>Search Users</h1>


<form method="GET">
    <input type="text" id="search-box" name="q" placeholder="Search users..." autocomplete="off">
    <button type="submit">Search</button>
</form>

<div id="suggestions"></div>

<div class="user-list">
    {% for user in users %}
        <a href="{% url 'user_profile' user.username %}">{{ user.username }}</a>
    {% empty %}
        <p>No users found</p>
    {% endfor %}
</div>

<script>
const searchBox = document.getElementById('search-box');
const suggestionsDiv = document.getElementById('suggestions');

searchBox.addEventListener('keyup', function() {
    const query = searchBox.value;

    if (query.length === 0) {
        suggestionsDiv.innerHTML = '';
        return;
    }

    fetch(`/ajax/search_users/?q=${query}`)
        .then(response => response.json())
        .then(data => {
            suggestionsDiv.innerHTML = '';
            data.users.forEach(user => {
                const div = document.createElement('div');
                div.textContent = user;
                div.style.cursor = 'pointer';
                div.addEventListener('click', () => {
                    window.location.href = `/profile/${user}/`;
                });
                suggestionsDiv.appendChild(div);
            });
        });
});
</script>

</body>
</html>
